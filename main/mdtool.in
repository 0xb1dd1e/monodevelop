#!/bin/bash

#this script should be in $PREFIX/bin
PREFIX="${0%%/mdtool}/.."

MD_FORCE_DEBUG=yes

for arg in $*; do 
case x$arg in
	x--profile*)
		MONO_OPTIONS="$MONO_OPTIONS $arg"
		shift
		;;
	x--debug*)
		export MONODEVELOP_DISPATCH_DEBUG=yes
		unset MD_FORCE_DEBUG
		MONO_OPTIONS="$MONO_OPTIONS $arg"
		shift
		;;
	x--trace*)
		MONO_OPTIONS="$MONO_OPTIONS $arg"
		shift
		;;
	x--no-debug)
		unset MD_FORCE_DEBUG
		shift
		;;
	*)
		ARGS="$ARGS $arg"
		shift
		;;
esac		
done

if [ -z MD_FORCE_DEBUG ]; then
	MONO_OPTIONS="$MONO_OPTIONS --debug"
fi

if [ -n "$MONO_OPTIONS" ]; then
	echo "** Running with Mono options: $MONO_OPTIONS **"
fi

exec_args="-a mdtool mono $MONO_OPTIONS $PREFIX/lib/monodevelop/bin/mdrun.exe $ARGS"

exec $exec_args

