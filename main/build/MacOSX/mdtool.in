#!/bin/sh

# Author: Marc Christensen (mchristensen@novell.com)

reWrite() {
    ret=""
    WD=`pwd`
    for arg in "$@"
    do
	if [ -f "./$arg" ]
	then
	    ret="$ret '$WD/$arg'"
	else
	    ret="$ret '$arg'"
	fi
   done

    echo "$ret"
}
 
MD_BIN_PATH=/tmp/install/lib/monodevelop/bin

### SYNCH BLOCK: any changes to this block should be kept in sync with the one in Makefile.include and monodevelop.in
MD_PKG_CONFIG_PATH=/tmp/build_deps/lib/pkgconfig/:/usr/lib/pkgconfig/:/usr/local/lib/pkgconfig/:/usr/share/pkgconfig/:/usr/local/share/pkgconfig/
if test -d /usr/lib64; then MD_PKG_CONFIG_PATH=$MD_PKG_CONFIG_PATH:/usr/lib64/pkgconfig/:/usr/local/lib64/pkgconfig/; fi
### END BLOCK

if [ -n $PKG_CONFIG_PATH ]; then
	export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:$MD_PKG_CONFIG_PATH
else
	export PKG_CONFIG_PATH=$MD_PKG_CONFIG_PATH
fi

eval set -- `reWrite "$@"`

case x$1 in
	x--profile)
		shift
		exec -a "mdtool" /tmp/build_deps/bin/mono --profile $MD_BIN_PATH/mdrun.exe "$@"
		exit 0
		;;
	x--debug)
		shift
		export MONODEVELOP_DISPATCH_DEBUG=yes
		exec -a "mdtool" /tmp/build_deps/bin/mono --debug $MD_BIN_PATH/mdrun.exe "$@"
		exit 0
		;;
	x--trace)
		shift
		exec -a "mdtool" /tmp/build_deps/bin/mono --trace $MD_BIN_PATH/mdrun.exe "$@"
		exit 0;
		;;
esac

exec /tmp/build_deps/bin/mono $MD_BIN_PATH/mdrun.exe "$@"

